<script src="https://cdn.polyfill.io/v2/polyfill.min.js"></script>


<script type="text/javascript">

  function heightCalc(){

    // apply padding based on clientHeight for first modal on the page...
    const modalBody    = document.getElementsByClassName('modalBody')[0];
    const modalContent = document.getElementsByClassName('modalContent')[0];
    const modalOverlay = document.getElementsByClassName('modalOverlay')[0];
    const header       = document.getElementsByClassName('modalHeader')[0];
    const footer       = document.getElementsByClassName('modalFooter')[0];

    const windowHeight  = window.innerHeight;
    const contentHeight = modalContent.getBoundingClientRect().height;
    const paddingHeight = (windowHeight - contentHeight) / 2;
    const padding       = paddingHeight > 60 ? paddingHeight : 60;
    const headerHeight  = header.getBoundingClientRect().height;
    const footerHeight  = footer ? footer.getBoundingClientRect().height : 0;

    // apply padding based on clientHeight for second modal on the page...
    const modalBody2    = document.getElementsByClassName('modalBody')[1];
    const modalOverlay2 = document.getElementsByClassName('modalOverlay')[1];
    const header2       = document.getElementsByClassName('modalHeader')[1];
    const modalContent2 = document.getElementsByClassName('modalContent')[1];

    const contentHeight2 = modalContent2.getBoundingClientRect().height;
    const paddingHeight2 = (windowHeight - contentHeight2) / 2;
    const padding2       = paddingHeight2 > 60 ? paddingHeight2 : 60;
    const headerHeight2  = header2.getBoundingClientRect().height;

    // calculate body max...
    modalBody.style.maxHeight        = `${windowHeight - (headerHeight + footerHeight + 120)}px`;
    modalOverlay.style.paddingTop    = `${padding}px`;
    modalOverlay.style.paddingBottom = `${padding}px`;

    modalBody2.style.maxHeight       = `${windowHeight - (headerHeight2 + 120)}px`;
    modalOverlay2.style.paddingTop   = `${padding2}px`;
    modalOverlay.style.paddingBottom = `${padding2}px`;

    // conditional borders on modalbody if scrollbar is present...
    modalBody.className  = (modalBody.clientHeight  < modalBody.scrollHeight)  ? 'modalBody modalBody_border' : 'modalBody modalBody_border_normal';
    modalBody2.className = (modalBody2.clientHeight < modalBody2.scrollHeight) ? 'modalBody modalBody_border' : 'modalBody modalBody_border_normal';

  }


   function toggleModal(target){

     const portal            = document.getElementById(target);
     const footerCloseButton = document.getElementsByClassName('modalCancel')[0];
     const headerCloseButton = document.getElementsByClassName('modalClose')[1];

     // toggle modal...
     portal.style.display = portal.style.display === "none" ? "" : "none";

     //*****MODAL OPEN**************
     if(portal.style.display === ""){

      // calulate max-height for modalBody
      // and apply conditional scrollbars....
      heightCalc();

      // detect ESC KeyPress...
      document.addEventListener("keyup", e => e.keyCode == 27 ? portal.style.display = "none" : null);

      // apply focus to close button...
      headerCloseButton ? headerCloseButton.focus() : null;
      footerCloseButton ? footerCloseButton.focus() : null;

      // if open stop page underneath from scrolling...
      document.body.style = "overflow:hidden;";

     }

     //*****MODAL CLOSED**************
     portal.style.display === "none" ? document.body.style = "" : null;

   }


</script>
