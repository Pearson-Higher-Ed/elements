<script src="https://cdn.polyfill.io/v2/polyfill.min.js"></script>


<script type="text/javascript">

  function heightCalc() {
    var modalContent = document.getElementsByClassName('modalContent')[0];
    var modalOverlay = document.getElementsByClassName('modalOverlay')[0];
    var modalBody = document.getElementsByClassName('modalBody')[0];
    var header = document.getElementsByClassName('modalHeader')[0];
    var footer = document.getElementsByClassName('modalFooter')[0];

    var windowHeight = window.innerHeight;
    var contentHeight = modalContent.getBoundingClientRect().height;
    var paddingHeight = (windowHeight - contentHeight) / 2;
    var padding = paddingHeight > 60 ? paddingHeight : 60;
    var headerHeight = header.getBoundingClientRect().height;
    var footerHeight = footer ? footer.getBoundingClientRect().height : 0;

    // apply padding based on clientHeight for second modal on the page...
    var modalBody2 = document.getElementsByClassName('modalBody')[1];
    var modalOverlay2 = document.getElementsByClassName('modalOverlay')[1];
    var header2 = document.getElementsByClassName('modalHeader')[1];
    var modalContent2 = document.getElementsByClassName('modalContent')[1];

    var contentHeight2 = modalContent2.getBoundingClientRect().height;
    var paddingHeight2 = (windowHeight - contentHeight2) / 2;
    var padding2 = paddingHeight2 > 60 ? paddingHeight2 : 60;
    var headerHeight2 = header2.getBoundingClientRect().height;

    // calculate body max...
    modalBody.style.maxHeight = windowHeight - (headerHeight + footerHeight + 120) + "px";
    modalOverlay.style.paddingTop = padding + "px";
    modalOverlay.style.paddingBottom = padding + "px";

    modalBody2.style.maxHeight = windowHeight - (headerHeight2 + 120) + "px";
    modalOverlay2.style.paddingTop = padding2 + "px";
    modalOverlay.style.paddingBottom = padding2 + "px";

    // conditional borders on modalbody if scrollbar is present...
    modalBody.className = modalBody.clientHeight < modalBody.scrollHeight ? 'modalBody modalBody_border' : 'modalBody modalBody_border_normal';
    modalBody2.className = modalBody2.clientHeight < modalBody2.scrollHeight ? 'modalBody modalBody_border' : 'modalBody modalBody_border_normal';
  }

  function toggleModal(target) {

    var portal = document.getElementById(target);
    var footerCloseButton = document.getElementsByClassName('modalCancel')[0];
    var headerCloseButton = document.getElementsByClassName('modalClose')[1];

    // toggle modal...
    portal.style.display = portal.style.display === "none" ? "" : "none";

    //*****MODAL OPEN**************
    if (portal.style.display === "") {

      // calulate max-height for modalBody
      // and apply conditional scrollbars....
      heightCalc();

      // detect ESC KeyPress...
      document.addEventListener("keyup", function (e) {
        e.keyCode == 27 ? portal.style.display = "none" : null;
      });

      // apply focus to close button...
      headerCloseButton ? headerCloseButton.focus() : null;
      footerCloseButton ? footerCloseButton.focus() : null;

      // if open stop page underneath from scrolling...
      document.body.style = "overflow:hidden;";
    }

    //*****MODAL CLOSED**************
    portal.style.display === "none" ? document.body.style = "" : null;
  }


</script>
